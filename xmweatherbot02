#–∏–º–ø–æ—Ä—Ç
import telebot
import pyowm
from telebot import types
#owm
owm = pyowm.OWM('b1c89f460a40430fd4a0214d984230ce',language='ru') 
# telebot
TOKEN='1129677508:AAEdpIa5SpUWam78lYud6rFyc2W-j4iVj5c'
bot=telebot.TeleBot(TOKEN)


#—Å—Ç–∞—Ä—Ç
@bot.message_handler(commands=['start'])
def start(message):
    bot.send_sticker(message.chat.id,'CAACAgIAAxkBAAPuXpNPjdOilp7Ja3mOu5T9S76S3CkAAiIBAAKmREgLEfW5zI8V9GYYBA')
    bot.send_message(message.chat.id, "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {0.first_name}!\n----------------------------\n–Ø - <b>{1.first_name}</b>, –±–æ—Ç –ø–æ–≥–æ–¥—ã)üå§\n----------------------------\n—á—Ç–æ–±—ã –æ–∑–Ω–∞–∫–æ–º–∏—Ç—Å—è —Å –±–æ—Ç–æ–º‚öôÔ∏è-/help.".format(message.from_user, bot.get_me()),
        parse_mode='html')


#podpiska
@bot.message_handler(commands=['podpiska'])
def help(message):
    markup=telebot.types.InlineKeyboardMarkup()
    #–∫–Ω–æ–ø–∫–∏ –∫–∞–ª–±–µ–∫
    button1=telebot.types.InlineKeyboardButton(text='—ç–∂–¥–Ω–µ–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫—É‚úÖ', callback_data='den')
    button2=telebot.types.InlineKeyboardButton(text='–µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫—É‚úÖ', callback_data='nedelya')

    markup.add(button1)
    markup.add(button2)    
    
    bot.send_message(chat_id=message.chat.id, text='''
    —ç—Ç–æ—Ç –±–æ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ‚öôÔ∏èüîß\n
    _______________________________________\n
    –º–æ–∂–µ—Ç–µ –ø–æ–¥–ø–∏—Å–∞—Ç—Å—è –Ω–∞ –µ–∂–µ-–¥–Ω–µ–≤–Ω—É—é/–Ω–µ–¥–µ–ª—å–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É‚úÖ:''', reply_markup=markup)

@bot.callback_query_handler(func=lambda call: True)
def callback_inline(call):
    try:
        if call.message:
            if call.data == 'den':
                bot.answer_callback_query(callback_query_id=call.id, text='–ø–æ–¥–ø–∏—Å–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞')
            elif call.data == 'nedelya':
                bot.answer_callback_query(callback_query_id=call.id, text='Hello –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞')


#pogoda
@bot.message_handler(commands='pogoda')
def send_pogoda(message):
    try:
        bot.send_message(message.chat.id,'–∫–∞–∫–æ–π –≥–æ—Ä–æ–¥?')
        place=message.text
        observation = owm.weather_at_place(place)
        w = observation.get_weather()
        #–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤–µ—Ç—Ä–∞
        wind=w.get_wind ()['speed']
        #–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç–∏
        humi=w.get_humidity ()
        #–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
        tem=w.get_temperature('celsius')['temp']

        #—Å–≤–µ–¥–µ–Ω–∏—è –æ –ø–æ–≥–æ–¥–µ
        answer='—Å–µ–π—á–∞—Å –≤ '+place+' '+w.get_detailed_status()+'\n'
        answer+='–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –æ–∫–æ–ª–æ '+str(tem)+' c¬∞'+'\n'
        answer+= '–í–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞ –æ–∫–æ–ª–æ '+str(humi)+' %'+'\n'
        answer+='–°–∫–æ—Ä–æ—Å—Ç—å –≤–µ—Ç—Ä–∞ –æ–∫–∞–ª–∞ '+str(wind)+' –º/c'

    except pyowm.exceptions.api_response_error.NotFoundError:
      bot.send_message(message.chat.id, '–ì–æ—Ä–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω :(')
  
       

















bot.polling()
